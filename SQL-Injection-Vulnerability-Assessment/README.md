#  SQL Injection Vulnerability Assessment

![Lab Report](https://img.shields.io/badge/Status-Completed-brightgreen)
![Framework](https://img.shields.io/badge/Framework-Web%20Security-blue)
![Tools](https://img.shields.io/badge/Tools-SQLMap%20%26%20cURL-orange)
![Difficulty](https://img.shields.io/badge/Difficulty-Advanced-red)
![Duration](https://img.shields.io/badge/Duration-Multi%20Day-lightblue)

---

## **1. Lab Title**

> SQL Injection Vulnerability Assessment: Web Application Database Exploitation and Mitigation

---

## **2. Purpose and Objectives**

Demonstrate SQL Injection vulnerabilities in web applications through controlled exploitation of deliberately vulnerable systems. This exercise illustrates attack methodologies, database extraction techniques, and critical prevention mechanisms.

**Key Learning Outcomes:**
- Understand SQL Injection attack vectors and execution
- Identify improper input validation in web applications
- Demonstrate authentication bypass techniques
- Extract sensitive database information via injection
- Apply parameterized queries and input sanitization
- Implement Web Application Firewalls (WAF) for protection

---

## **3. Frameworks & Technologies**

- **SQL Injection** — Malicious SQL query insertion via user input fields
- **OWASP Top 10** — Critical web vulnerability classification
- **Authentication Bypass** — Logic manipulation via SQL operators
- **Database Extraction** — Union-based and error-based data retrieval
- **Input Validation** — Sanitization and parameterized query defense
- **Web Application Firewalls** — Protocol-level attack detection

---

## **4. Lab Environment**

**Tools Used:**
- Web browser (Chrome, Firefox, Edge)
- SQLMap (automated SQL injection framework)
- cURL (command-line HTTP client)
- Vulnerable test web application (SEED server)
- SQL database backend (MySQL/PostgreSQL)

**Test Environment:** Deliberately vulnerable web application with intentional SQL Injection vulnerabilities

---

## **5. Attack Methodologies & Results**

### **Task 1: Web-Based Authentication Bypass**

**Attack Vector:** SQL Injection via login form
**Payload:** `' OR 1=1 --`
**Target:** Admin authentication bypass

**Execution:**
- Accessed vulnerable login page
- Entered malicious payload in username field
- Query became: `SELECT * FROM users WHERE username='' OR 1=1 --' AND password='[any]'`
- The `OR 1=1` condition always evaluates TRUE
- Comment `--` removes password check from query
- Successfully logged in as admin without credentials

**Result:** ✅ Authentication bypassed; admin access gained

---

### **Task 2: Command-Line SQL Injection**

**Attack Vector:** HTTP GET parameter injection via cURL
**Payload:** `curl 'www.seed-server.com/unsafe_home.php?username=alice%27%20%23&Password=11'`

**Execution:**
- Used URL encoding: `%27` (single quote), `%20` (space)
- Injected: `alice' #` in username field
- Query became: `SELECT * FROM employees WHERE username='alice' # AND password='11'`
- Hash symbol `#` comments out password validation
- Retrieved Alice's account information and permissions

**Result:** ✅ Bypassed authentication without correct password; extracted user data

---

### **Task 3: UPDATE Statement Injection**

**Attack Vector:** SQL UPDATE query manipulation via profile modification
**Payload:** Injected malicious UPDATE into field: `username', password='backdoor123'#`

**Execution:**
- Located profile update functionality
- Identified vulnerable UPDATE statement in backend
- Injected payload in username/password fields
- Original query: `UPDATE employees SET username='[input]' WHERE id=[user_id]`
- Modified to: `UPDATE employees SET username='alice', password='backdoor123'# WHERE id=[user_id]`
- Successfully created backdoor credentials for unauthorized access

**Result:** ✅ Modified Alice's account; created persistent backdoor access

---

### **Task 4: Salary Modification Attack**

**Attack Vector:** SQL UPDATE injection targeting salary field
**Payload:** Injected salary parameter: `alice'; UPDATE employees SET salary=999999 WHERE username='alice'#`

**Execution:**
- Identified salary update endpoint
- Crafted chained SQL statements via injection
- First statement: normal profile update
- Second statement: salary modification to arbitrary value
- Successfully increased Alice's salary without authorization

**Result:** ✅ Modified salary field; demonstrated unauthorized data alteration

---

### **Task 5: Password Modification Attack**

**Attack Vector:** SQL UPDATE injection targeting password field with encryption bypass
**Payload:** Injected: `alice'; UPDATE employees SET password=PASSWORD('newpassword123') WHERE username='alice'#`

**Execution:**
- Located password reset functionality
- Identified encryption method used (MySQL PASSWORD() function)
- Crafted injection to update password with correct encryption
- Applied injection through vulnerable input field
- Successfully changed Alice's password to attacker-controlled value

**Result:** ✅ Modified password with proper encryption; account takeover complete

---

### **Task 6: Union-Based Data Extraction**

**Attack Vector:** UNION-based SQL injection for database enumeration
**Payload:** `' UNION SELECT username, password, email FROM users #`

**Execution:**
- Identified number of columns in original query (3)
- Crafted UNION statement with matching column count
- Retrieved data from multiple tables simultaneously
- Extracted usernames, password hashes, and email addresses

**Result:** ✅ Extracted sensitive database records; compromised multiple user accounts

---

### **Task 7: Error-Based Data Extraction**

**Attack Vector:** Malformed queries revealing database structure
**Payload:** `' AND (SELECT 1 FROM information_schema.tables WHERE table_schema=database())`

**Execution:**
- Submitted intentionally malformed SQL
- Database error messages revealed schema information
- Identified table names and structure
- Subsequent queries targeted specific tables and columns
- Extracted sensitive data through error message analysis

**Result:** ✅ Mapped database structure; identified high-value targets

---

## **6. Vulnerability Analysis**

| Attack Type | Severity | Data Impact | Ease of Execution |
|------------|----------|-------------|-------------------|
| Authentication Bypass | **CRITICAL** | User account compromise | Easy |
| Data Extraction | **CRITICAL** | Sensitive information exposure | Moderate |
| UPDATE Injection | **CRITICAL** | Unauthorized data modification | Moderate |
| Password Modification | **CRITICAL** | Complete account takeover | Moderate |
| Salary Manipulation | **HIGH** | Financial data tampering | Moderate |
| Error-based Extraction | **CRITICAL** | Full database mapping | Advanced |

---

## **7. Root Cause: Improper Input Validation**

**Vulnerability Pattern:** Directly concatenating user input into SQL queries

```
// VULNERABLE CODE EXAMPLE
$username = $_GET['username'];
$password = $_GET['password'];
$query = "SELECT * FROM users WHERE username='" . $username . "' AND password='" . $password . "'";
```

**Issue:** No input sanitization; special characters (quotes, semicolons, comments) passed directly to SQL

---

## **8. Prevention & Mitigation Strategies**

### **1. Parameterized Queries (Prepared Statements)**
```
// SECURE CODE EXAMPLE
$stmt = $pdo->prepare("SELECT * FROM users WHERE username = ? AND password = ?");
$stmt->execute([$username, $password]);
$result = $stmt->fetch();
```
- Input treated as data, never executable code
- SQL structure defined separately from user data

### **2. Input Validation & Sanitization**
- Whitelist allowed characters (alphanumeric, specific symbols)
- Reject queries containing SQL keywords (SELECT, UNION, DELETE, etc.)
- Validate data type (integers should be numeric only)
- Apply length restrictions

### **3. Least Privilege Database Access**
- Create separate database user with minimal permissions
- Restrict to SELECT queries where possible
- Remove UPDATE/DELETE privileges for non-administrative users
- Separate read-only and read-write database accounts

### **4. Web Application Firewall (WAF)**
- Deploy WAF with SQL injection detection rules
- Block requests containing SQL keywords
- Monitor for suspicious query patterns
- Alert on multiple failed authentication attempts

### **5. Error Handling**
- Display generic error messages to users
- Log detailed errors server-side only
- Avoid revealing database structure in error messages
- Implement rate limiting on failed queries

### **6. Security Testing & Monitoring**
- Regular penetration testing and code review
- Implement database activity monitoring
- Alert on unusual query patterns
- Maintain audit logs of database modifications

---

## **9. Key Takeaways**

- **SQL Injection is critical:** Requires minimal attacker skill; massive impact on data security
- **User input is untrusted:** All external input must be validated and parameterized
- **Prepared statements are essential:** Only reliable defense against SQL injection
- **Defense-in-depth required:** WAF, input validation, and privilege separation all necessary
- **Error messages leak data:** Verbose errors reveal database structure to attackers
- **Authentication can be bypassed:** Simple logic manipulation enables unauthorized access
- **Data modification possible:** UPDATE injection allows unauthorized account changes
- **Regular testing critical:** Security vulnerability scanning should be automated and continuous

---

## **10. Conclusion**

This SQL Injection lab successfully demonstrated critical vulnerabilities in web application security through controlled exploitation of deliberately vulnerable systems. By executing seven distinct attack vectors (authentication bypass, command-line injection, UPDATE manipulation, salary modification, password changes, UNION-based extraction, and error-based extraction), the exercise illustrated the severe risk SQL Injection poses to database security.

The root cause—improper input validation and direct SQL query concatenation—affects millions of web applications. Mitigation requires defense-in-depth: parameterized queries eliminate injection vectors, input validation provides additional protection, database privilege restriction limits damage scope, and WAF deployment detects attack patterns.

Organizations must prioritize secure coding practices, implement parameterized queries universally, conduct regular security testing, and deploy monitoring solutions to detect and respond to injection attempts. This lab reinforces that SQL Injection, despite being well-known and preventable, remains a critical threat to web application security.

---

## **11. References**

- OWASP SQL Injection Guide: https://owasp.org/www-community/attacks/SQL_Injection
- OWASP Top 10 Web Vulnerabilities: https://owasp.org/Top10/
- CWE-89 SQL Injection: https://cwe.mitre.org/data/definitions/89.html
- Parameterized Query Examples: https://owasp.org/www-community/attacks/SQL_Injection/Prevention
- Web Application Firewall Best Practices: https://www.incapsula.com/waf/sql-injection-prevention/

---

## **12. Artifacts & Deliverables**

- **Attack Payloads:** All SQL injection strings used in testing
- **Command Output:** Screenshots of successful exploitation
- **Query Logs:** Database queries revealing injection points
- **Vulnerable vs Secure Code:** Before/after code comparisons
- **Prevention Checklist:** Input validation procedures and WAF rules
- **Test Results:** Proof of authentication bypass and data extraction

---

**Lab Completed:** [Date] | **Attack Success Rate:** 100% | **Vulnerabilities Identified:** 7
