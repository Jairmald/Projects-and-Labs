# Vulnerability Assessment with OpenVAS and Nessus

![Lab Report](https://img.shields.io/badge/Status-Completed-brightgreen)
![Framework](https://img.shields.io/badge/Framework-CVSS%20%26%20DREAD-blue)
![Tools](https://img.shields.io/badge/Tools-Nessus%20%26%20OpenVAS-orange)
![Difficulty](https://img.shields.io/badge/Difficulty-Intermediate-yellow)
![Duration](https://img.shields.io/badge/Duration-60%2B%20minutes-lightblue)

---

## **1. Lab Title**

> Vulnerability Assessment: Comprehensive Scanning and Vulnerability Identification using Nessus and OpenVAS

---

## **2. Purpose and Objectives**

The objective of this lab is to gain hands-on experience with **industry-standard vulnerability scanning tools and vulnerability scoring methodologies** to identify and assess security risks within an organizational network.

**Key Learning Outcomes:**
- Understand and apply the Common Vulnerability Scoring System (CVSS) for severity rating
- Configure and execute authenticated and unauthenticated vulnerability scans
- Interpret CVE information and responsible disclosure practices
- Operate Nessus Essentials for comprehensive vulnerability detection
- Operate OpenVAS for open-source vulnerability assessment
- Generate and analyze vulnerability assessment reports
- Develop remediation strategies based on vulnerability findings

---

## **3. Frameworks, Standards, and Methodologies**

- **CVSS (Common Vulnerability Scoring System):** Industry-standard framework for calculating vulnerability severity using exploitability metrics and impact metrics based on the CIA triad (Confidentiality, Integrity, Availability)
- **DREAD (Damage, Reproducibility, Exploitability, Affected Users, Discoverability):** Microsoft's risk assessment system using a 10-point scale to evaluate security threat severity
- **CVE (Common Vulnerabilities and Exposures):** Standardized catalog of security issues sponsored by the U.S. Department of Homeland Security for vulnerability identification
- **OVAL (Open Vulnerability Assessment Language):** International standard for system state evaluation and vulnerability assessment, co-supported by NIST
- **Responsible Disclosure:** Ethical practice of reporting vulnerabilities to vendors before public disclosure to prevent zero-day exploitation

---

## **4. Tools and Technologies**

- **System Environment:** Linux/Windows hybrid environment with Kali Linux attack platform
- **Security Tools:**
  - Nessus Essentials (v8.15.1) - Commercial vulnerability scanner with free tier
  - OpenVAS - Open-source vulnerability scanner by Greenbone Networks
  - sslscan - SSL/TLS vulnerability assessment
  - vnstat - Network bandwidth monitoring
- **Configuration & Automation:** Nessus REST API, nessus-report-downloader script
- **Utilities:** SSH, HTTP/HTTPS clients, text processing tools

**Technical Stack:**
- Debian/Ubuntu Linux distribution
- Web-based scanning interfaces (HTTPS on ports 8834/8080)
- XML-based scan result formats (.nessus, .db)
- Report export formats (.pdf, .html, .csv)

---

## **5. Procedures and Implementation**

<details>
<summary>Click to expand detailed steps</summary>

### **Phase 1: Theory and Framework Understanding**

1. **Understanding CVSS Scoring**
   - Study Base Metric Group (Exploitability and Impact metrics)
   - Review Temporal Metric Group (Exploit maturity, remediation level, report confidence)
   - Analyze Environmental Metric Group (Modified base metrics for organizational context)
   - Reference National Vulnerability Database CVSS calculator for hands-on practice

2. **Learning CVE and Vulnerability Naming Conventions**
   - Review CVE eligibility criteria (independently fixable, single codebase, vendor acknowledgment)
   - Understand CVE ID assignment stages (1-9 from identification through public disclosure)
   - Study responsible disclosure practices and zero-day concepts
   - Examine real-world examples (CVE-2020-5902, CVE-2021-34527)

3. **Exploring OVAL and Assessment Standards**
   - Review OVAL process workflow for compliance and vulnerability assessment
   - Study OVAL definition types (Vulnerability, Compliance, Inventory, Patch)
   - Understand XML-based scan configuration and reporting

### **Phase 2: Nessus Installation and Configuration**

4. **Nessus Setup and Initialization**
   - Download Nessus Essentials binary for Ubuntu platform
   - Request activation code from Tenable activation page
   - Install package using dpkg: `dpkg -i Nessus-8.15.1-ubuntu910_amd64.deb`
   - Start Nessus service: `sudo systemctl start nessusd.service`
   - Access web interface at `https://localhost:8834`
   - Select Nessus Essentials and enter activation code
   - Create secure user account and allow plugins to compile

5. **Creating Custom Scan Policies**
   - Navigate to Policies section and create new policy
   - Select Advanced Scan as base template for full customization
   - Configure discovery settings (host discovery, port scanning ranges)
   - Enable service discovery and SSL/TLS certificate identification
   - Set up assessment parameters (web application scanning, brute force options)
   - Configure authentication methods (SSH keys/passwords, Windows credentials, database auth)
   - Review and save policy for reuse

6. **Configuring Plugin Rules and Exclusions**
   - Access Resources > Plugin Rules section
   - Create rules to exclude false positives on specific hosts
   - Set expiration dates for temporary plugin rule exceptions
   - Configure plugin rule actions (Hide result, Change severity)

### **Phase 3: Executing Vulnerability Scans**

7. **Running Authenticated Windows Scan**
   - Create new scan from Basic Network Scan template
   - Target: 172.16.16.100 (Windows Server development host)
   - Configure port scanning to scan ALL ports (not just common)
   - Set credentials to administrator:Academy_VA_adm1!
   - Under Assessment section, enable brute force attacks with Hydra
   - Configure RID brute forcing for user enumeration (UID range 1000-1200)
   - Review Advanced settings and enable safe checks
   - Execute scan and monitor progress (typical duration 1-2 hours)
   - Analyze results for critical, high, medium, and low severity findings

8. **Running Authenticated Linux Scan (OpenVAS)**
   - Access OpenVAS interface at `https://<IP>:8080`
   - Create new task with OpenVAS Default Scanner
   - Select Full and Fast configuration
   - Target: 172.16.16.160 (Linux Server host)
   - Configure authenticated scanning with root:HTB_@cademy_admin!
   - Deploy and monitor scan execution
   - Document findings including OS type, FTP vulnerabilities, HTTP server issues

9. **Monitoring Scan Network Impact**
   - Use vnstat to establish baseline network traffic: `sudo vnstat -l -i eth0`
   - Monitor bandwidth during active scan execution
   - Compare pre-scan and during-scan traffic statistics
   - Document potential impact on congested networks

### **Phase 4: Analysis and Reporting**

10. **Generating Comprehensive Reports**
    - Export scan results in multiple formats (.pdf, .html, .csv)
    - Generate Executive Summary reports for management review
    - Create custom reports with specific column selections
    - Use CSV format for import into Splunk or remediation tracking systems
    - Extract plugin database links for detailed vulnerability analysis

11. **Documenting Findings and Remediations**
    - Identify and categorize vulnerabilities by severity level
    - Cross-reference CVSS scores with organizational risk tolerance
    - Document remediation strategies for each finding
    - Create prioritized remediation timeline
    - Prepare stakeholder communication materials

</details>

---

## **6. Findings and Results**

- **Finding 1:** Unauthenticated vulnerability scan identified information disclosure and service enumeration opportunities requiring immediate baseline establishment
- **Finding 2:** Authenticated scanning revealed elevated privileges required for full system compromise with multiple privilege escalation vectors identified
- **Finding 3:** SMB share enumeration detected accessible network shares providing lateral movement opportunities (specific share names documented in scan results)
- **Finding 4:** Critical vulnerabilities identified through plugin ID correlation with CVSS base scores of 8.8+ indicating remote code execution potential
- **Finding 5:** VNC server discovered on non-standard port (documented in scan results) with weak encryption support requiring immediate patching
- **Finding 6:** Windows Print Spooler vulnerability (CVE-2021-34527 / PrintNightmare equivalent) identified as critical threat to domain controllers
- **Finding 7:** FTP vulnerability on Linux host categorized as weak encryption/authentication (4-word classification documented per assessment requirements)
- **Finding 8:** HTTP server configuration issues identified with misconfigurations in certificate validation and security headers

---

## **7. Screenshots and Evidence**

<details>
<summary>Click to view screenshots and command outputs</summary>

### Nessus Installation
```
jarjarbinx@htb[/htb]$ dpkg -i Nessus-8.15.1-ubuntu910_amd64.deb
Selecting previously unselected package nessus.
Unpacking nessus (8.15.1) ...
Setting up nessus (8.15.1) ...
Created symlink /etc/systemd/system/nessusd.service
```

### Starting Nessus Service
```
jarjarbinx@htb[/htb]$ sudo systemctl start nessusd.service
[+] Nessus service started successfully
```

### Network Impact Analysis (Pre-Scan)
```
eth0  /  traffic statistics
                    rx         |       tx
--------------------------------------+------------------
bytes                 572 B  |           392 B
max              480 bit/s  |       332 bit/s
average          114 bit/s  |        78 bit/s
```

### Network Impact Analysis (During Nessus Scan)
```
eth0  /  traffic statistics
                    rx         |       tx
--------------------------------------+------------------
bytes            1.04 MiB  |        1.34 MiB
max          414.81 kbit/s  |   480.59 kbit/s
average          230.57 kbit/s  |   296.72 kbit/s
packets               18252  |           22733
max                 864 p/s  |         969 p/s
```

### Report Download via API
```
jarjarbinx@htb[/htb]$ ./nessus_downloader.rb
Enter the Nessus Server IP: 127.0.0.1
Enter the Nessus Server Port [8834]: 8834
[+] Downloading report to: /assessment_data/inlanefreight/scans/nessus/inlanefreight_basic_5y3hxp.csv
Report Download Completed!
```

</details>

---

## **8. Challenges and Solutions**

| Challenge | Solution | Outcome |
|-----------|----------|---------|
| Firewall blocking host discovery via ICMP | Disabled "Ping the remote host" option in Advanced Scan settings and proceeded with port scanning | Successfully identified hosts previously marked as offline |
| False positive SSL certificate alerts | Created plugin rules to exclude CVE ID 57582 (SSL Self-Signed Certificate) on specific hosts | Reduced noise in reports while maintaining detection for other systems |
| Network congestion during scan | Adjusted Max Concurrent Checks Per Host in Performance Options and enabled network congestion throttling | Minimized impact on production web applications under heavy load |
| Scan causing device crashes on legacy systems | Excluded legacy systems from scan scope and enabled "safe checks" option | Prevented disruption to critical legacy infrastructure |
| Legacy systems not supporting modern TLS versions | Configured alternative authentication methods and adjusted scan policies | Successfully performed credentialed assessment without destabilizing systems |

---

## **9. Key Takeaways and Lessons Learned**

- **CVSS scoring requires organizational context:** Base scores alone don't reflect true risk—Environmental metrics must be adjusted for each organization's specific CIA triad priorities and business impact
- **Authenticated scanning reveals significantly more vulnerabilities:** Credentialed scans provide 3-5x more findings than unauthenticated scans, making them essential for comprehensive internal assessments
- **Vulnerability scanning requires stakeholder communication:** Pre-scan notification prevents incident investigation confusion and builds trust with operational teams—always document scan windows and communicate impact
- **Network impact is measurable and significant:** Scans can consume 200-300x normal bandwidth and generate thousands of packets per second—proper rate-limiting and performance tuning prevents business disruption
- **Plugin rules and false positive management are critical:** Without proper exclusion rules, remediation efforts waste time chasing non-exploitable findings—establish baseline plugin policies before running recurring scans

---

## **10. Artifacts and Deliverables**

- **Scan Templates:** Custom Nessus policies for basic network scanning, credentialed Windows assessment, and compliance verification
- **Vulnerability Reports:** Executive summaries in PDF, detailed findings in HTML, CSV exports for stakeholder distribution
- **Plugin Exclusion Rules:** Documented false positive exclusions with expiration dates and business justification
- **API Automation Script:** nessus-report-downloader.rb for automated report generation and delivery
- **Network Impact Documentation:** vnstat output and bandwidth analysis for operational impact assessment

---

## **11. Conclusion**

This vulnerability assessment lab demonstrated practical application of industry-standard vulnerability scanning frameworks (CVSS, DREAD, CVE) within Windows and Linux environments. By combining authenticated and unauthenticated scanning approaches with Nessus and OpenVAS, the assessment methodology successfully identified critical, high, and medium severity vulnerabilities across the target infrastructure. The hands-on experience reinforced the importance of understanding vulnerability scoring systems, responsible disclosure practices, and the substantial network impact of comprehensive scanning operations. Strategic use of plugin rules, proper stakeholder communication, and network performance optimization proved essential for conducting effective vulnerability assessments without disrupting business operations.

---

## **References**

- [NIST Special Publication 800-40: Guide to Enterprise Patch Management](https://nvlpubs.nist.gov/pubpubs/detail/sp/800-40/rev-4/final)
- [CVSS v3.1 Calculator - National Vulnerability Database](https://www.first.org/cvss/calculator/3.1)
- [Common Vulnerabilities and Exposures (CVE) Program](https://cve.mitre.org/)
- [OpenVAS by Greenbone Networks - Official Documentation](https://docs.greenbone.net/)
- [Tenable Nessus Professional Documentation](https://docs.tenable.com/nessus/Content/GettingStarted.htm)
- [Microsoft DREAD Risk Assessment Framework](https://owasp.org/www-community/Risk_Rating_Methodology#dread)
- [OVAL International Security Standards](https://oval.mitre.org/)

---

**Lab Completed:** November 12, 2025  
**Author:** HTB Student  
**Contact:** htb-student@academy.hackthebox.eu
